{"version":3,"file":"pdfjs-viewer.min.js.map","sources":["pdfjs-viewer.js"],"sourcesContent":["/**\n   Copyright 2021 Carlos A. (https://github.com/dealfonso)\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n*/\n\n(function (exports, $) {\n\t\"use strict\";\n\tif ($ === undefined) {\n\t\tconsole.error(\"jQuery-like library not available\");\n\t\treturn;\n\t}\n\tlet defaults = {\n\t\tvisibleThreshold: .5,\n\t\textraPagesToLoad: 3,\n\t\tpageClass: \"pdfpage\",\n\t\tcontentClass: \"content-wrapper\",\n\t\tonDocumentReady: () => {},\n\t\tonNewPage: (page, i) => {},\n\t\tonPageRender: (page, i) => {},\n\t\tzoomValues: [.25, .5, .75, 1, 1.25, 1.5, 2, 4, 8],\n\t\tonZoomChange: zoomlevel => {},\n\t\tonActivePageChanged: (page, i) => {},\n\t\tzoomFillArea: .95,\n\t\temptyContent: () => $('<div class=\"loader\"></div>'),\n\t\trenderingScale: 1.5\n\t};\n\tclass Zoomer {\n\t\tconstructor(viewer, options = {}) {\n\t\t\tlet defaults = {\n\t\t\t\tzoomValues: [.25, .5, .75, 1, 1.25, 1.5, 2, 4, 8],\n\t\t\t\tfillArea: .9\n\t\t\t};\n\t\t\tthis.current = 1;\n\t\t\tthis.viewer = viewer;\n\t\t\tthis.settings = Object.assign({}, defaults, options);\n\t\t\tthis.settings.zoomValues = this.settings.zoomValues.sort();\n\t\t}\n\t\tget(zoom = null) {\n\t\t\tif (zoom === null) {\n\t\t\t\treturn this.current;\n\t\t\t}\n\t\t\tif (parseFloat(zoom) == zoom) {\n\t\t\t\treturn zoom;\n\t\t\t}\n\t\t\tlet $activepage = this.viewer.getActivePage();\n\t\t\tlet zoomValues = [];\n\t\t\tswitch (zoom) {\n\t\t\tcase \"in\":\n\t\t\t\tzoom = this.current;\n\t\t\t\tzoomValues = this.settings.zoomValues.filter(x => x > zoom);\n\t\t\t\tif (zoomValues.length > 0) {\n\t\t\t\t\tzoom = Math.min(...zoomValues);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"out\":\n\t\t\t\tzoom = this.current;\n\t\t\t\tzoomValues = this.settings.zoomValues.filter(x => x < zoom);\n\t\t\t\tif (zoomValues.length > 0) {\n\t\t\t\t\tzoom = Math.max(...zoomValues);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"fit\":\n\t\t\t\tzoom = Math.min(this.get(\"width\"), this.get(\"height\"));\n\t\t\t\tbreak;\n\t\t\tcase \"width\":\n\t\t\t\tzoom = this.settings.fillArea * this.viewer.$container.width() / $activepage.data(\"width\");\n\t\t\t\tbreak;\n\t\t\tcase \"height\":\n\t\t\t\tzoom = this.settings.fillArea * this.viewer.$container.height() / $activepage.data(\"height\");\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tzoom = this.current;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn zoom;\n\t\t}\n\t\tzoomPages(zoom) {\n\t\t\tzoom = this.get(zoom);\n\t\t\tthis.viewer.getPages().forEach(function (page) {\n\t\t\t\tlet $page = page.$div;\n\t\t\t\tlet c_width = $page.data(\"width\");\n\t\t\t\tlet c_height = $page.data(\"height\");\n\t\t\t\t$page.width(c_width * zoom).height(c_height * zoom);\n\t\t\t\t$page.data(\"zoom\", zoom);\n\t\t\t\t$page.find(`.${this.viewer.settings.contentClass}`).width(c_width * zoom).height(c_height * zoom);\n\t\t\t}.bind(this));\n\t\t\tthis.current = zoom;\n\t\t}\n\t}\n\tclass PDFjsViewer {\n\t\tversion = \"2.0.0\";\n\t\tconstructor($container, options = {}) {\n\t\t\tthis.settings = Object.assign({}, defaults, options);\n\t\t\tthis._zoom = new Zoomer(this, {\n\t\t\t\tzoomValues: this.settings.zoomValues,\n\t\t\t\tfillArea: this.settings.zoomFillArea\n\t\t\t});\n\t\t\t$container = $($container);\n\t\t\tthis.$container = $container;\n\t\t\t$container.get(0)._pdfjsViewer = this;\n\t\t\tthis._setScrollListener();\n\t\t\tthis.pages = [];\n\t\t\tthis.pdf = null;\n\t\t\tthis._documentReady = false;\n\t\t}\n\t\tsetZoom(zoom) {\n\t\t\tlet container = this.$container.get(0);\n\t\t\tlet prevzoom = this._zoom.current;\n\t\t\tlet prevScroll = {\n\t\t\t\ttop: container.scrollTop,\n\t\t\t\tleft: container.scrollLeft\n\t\t\t};\n\t\t\tthis._zoom.zoomPages(zoom);\n\t\t\tcontainer.scrollLeft = prevScroll.left * this._zoom.current / prevzoom;\n\t\t\tcontainer.scrollTop = prevScroll.top * this._zoom.current / prevzoom;\n\t\t\tthis._visiblePages(true);\n\t\t\tif (this._documentReady) {\n\t\t\t\tif (typeof this.settings.onZoomChange === \"function\") this.settings.onZoomChange.call(this, this._zoom.current);\n\t\t\t\tthis.$container.get(0).dispatchEvent(new CustomEvent(\"zoomchange\", {\n\t\t\t\t\tdetail: {\n\t\t\t\t\t\tzoom: this._zoom.current\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t\treturn this._zoom.current;\n\t\t}\n\t\tgetZoom() {\n\t\t\treturn this._zoom.current;\n\t\t}\n\t\t_cleanPage($page) {\n\t\t\tlet $emptyContent = this.settings.emptyContent();\n\t\t\t$page.find(`.${this.settings.contentClass}`).html(\"\").append($emptyContent);\n\t\t}\n\t\t_setPageContent($page, $content) {\n\t\t\t$page.find(`.${this.settings.contentClass}`).html(\"\").append($content);\n\t\t}\n\t\trefreshAll() {\n\t\t\tthis._visiblePages(true);\n\t\t}\n\t\t_setScrollListener() {\n\t\t\tlet scrollLock = false;\n\t\t\tlet scrollPos = {\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t};\n\t\t\tthis.__scrollHandler = function (e) {\n\t\t\t\tif (scrollLock === true) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tscrollLock = true;\n\t\t\t\tlet container = this.$container.get(0);\n\t\t\t\tif (Math.abs(container.scrollTop - scrollPos.top) > container.clientHeight * .2 * this._zoom.current || Math.abs(container.scrollLeft - scrollPos.left) > container.clientWidth * .2 * this._zoom.current) {\n\t\t\t\t\tscrollPos = {\n\t\t\t\t\t\ttop: container.scrollTop,\n\t\t\t\t\t\tleft: container.scrollLeft\n\t\t\t\t\t};\n\t\t\t\t\tthis._visiblePages();\n\t\t\t\t}\n\t\t\t\tscrollLock = false;\n\t\t\t}.bind(this);\n\t\t\tthis.$container.off(\"scroll\");\n\t\t\tthis.$container.on(\"scroll\", this.__scrollHandler);\n\t\t}\n\t\t_createSkeleton(page, i) {\n\t\t\tlet pageinfo = {\n\t\t\t\t$div: null,\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\tloaded: false\n\t\t\t};\n\t\t\tif (page.getViewport !== undefined) {\n\t\t\t\tlet viewport = page.getViewport({\n\t\t\t\t\trotation: this._rotation,\n\t\t\t\t\tscale: 1\n\t\t\t\t});\n\t\t\t\tpageinfo.width = viewport.width;\n\t\t\t\tpageinfo.height = viewport.height;\n\t\t\t\tpageinfo.loaded = true;\n\t\t\t} else {\n\t\t\t\tpageinfo.width = page.width;\n\t\t\t\tpageinfo.height = page.height;\n\t\t\t}\n\t\t\tconsole.assert(pageinfo.width > 0 && pageinfo.height > 0, \"Page width and height must be greater than 0\");\n\t\t\tpageinfo.$div = $(`<div id=\"page-${i}\">`).attr(\"data-page\", i).data(\"width\", pageinfo.width).data(\"height\", pageinfo.height).data(\"zoom\", this._zoom.current).addClass(this.settings.pageClass).width(pageinfo.width * this._zoom.current).height(pageinfo.height * this._zoom.current);\n\t\t\tlet $content = $(`<div class=\"${this.settings.contentClass}\">`).width(pageinfo.width).height(pageinfo.height);\n\t\t\tpageinfo.$div.append($content);\n\t\t\tthis._cleanPage(pageinfo.$div);\n\t\t\treturn pageinfo;\n\t\t}\n\t\t_placeSkeleton(pageinfo, i) {\n\t\t\tlet prevpage = i - 1;\n\t\t\tlet $prevpage = null;\n\t\t\twhile (prevpage > 0 && ($prevpage = this.$container.find(`.${this.settings.pageClass}[data-page=\"${prevpage}\"]`)).length === 0) {\n\t\t\t\tprevpage--;\n\t\t\t}\n\t\t\tif (prevpage === 0) {\n\t\t\t\tthis.$container.append(pageinfo.$div);\n\t\t\t} else {\n\t\t\t\t$prevpage.after(pageinfo.$div);\n\t\t\t}\n\t\t}\n\t\t_createSkeletons(pageinfo) {\n\t\t\tfor (let i = 1; i <= this.pageCount; i++) {\n\t\t\t\tif (this.pages[i] === undefined) {\n\t\t\t\t\tpageinfo = this._createSkeleton(pageinfo, i);\n\t\t\t\t\tthis.pages[i] = pageinfo;\n\t\t\t\t\tthis._placeSkeleton(pageinfo, i);\n\t\t\t\t\tif (typeof this.settings.onNewPage === \"function\") {\n\t\t\t\t\t\tthis.settings.onNewPage.call(this, pageinfo.$div.get(0), i);\n\t\t\t\t\t}\n\t\t\t\t\tthis.$container.get(0).dispatchEvent(new CustomEvent(\"newpage\", {\n\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\tpageNumber: i,\n\t\t\t\t\t\t\tpage: pageinfo.$div.get(0)\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_setActivePage(i) {\n\t\t\tif (this._activePage !== i) {\n\t\t\t\tthis._activePage = i;\n\t\t\t\tlet activePage = this.getActivePage();\n\t\t\t\tif (this._documentReady) {\n\t\t\t\t\tactivePage = activePage == null ? null : activePage.get(0);\n\t\t\t\t\tif (typeof this.settings.onActivePageChanged === \"function\") {\n\t\t\t\t\t\tthis.settings.onActivePageChanged.call(this, activePage, i);\n\t\t\t\t\t}\n\t\t\t\t\tthis.$container.get(0).dispatchEvent(new CustomEvent(\"activepagechanged\", {\n\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\tactivePageNumber: i,\n\t\t\t\t\t\t\tactivePage: activePage\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_areaOfPageVisible($page) {\n\t\t\tif ($page === undefined) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tlet c_offset = this.$container.offset();\n\t\t\tlet c_width = this.$container.width();\n\t\t\tlet c_height = this.$container.height();\n\t\t\tlet position = $page.offset();\n\t\t\tposition.top -= c_offset.top;\n\t\t\tposition.left -= c_offset.left;\n\t\t\tposition.bottom = position.top + $page.outerHeight();\n\t\t\tposition.right = position.left + $page.outerWidth();\n\t\t\tlet page_y0 = Math.min(Math.max(position.top, 0), c_height);\n\t\t\tlet page_y1 = Math.min(Math.max($page.outerHeight() + position.top, 0), c_height);\n\t\t\tlet page_x0 = Math.min(Math.max(position.left, 0), c_width);\n\t\t\tlet page_x1 = Math.min(Math.max($page.outerWidth() + position.left, 0), c_width);\n\t\t\tlet vis_x = page_x1 - page_x0;\n\t\t\tlet vis_y = page_y1 - page_y0;\n\t\t\treturn vis_x * vis_y;\n\t\t}\n\t\tisPageVisible(i) {\n\t\t\tif (this.pdf === null || i === undefined || i === null || i < 1 || i > this.pdf.numPages) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (typeof i === \"string\") {\n\t\t\t\ti = parseInt(i);\n\t\t\t}\n\t\t\tlet $page = i;\n\t\t\tif (typeof i === \"number\") {\n\t\t\t\tif (this.pages[i] === undefined) return false;\n\t\t\t\t$page = this.pages[i].$div;\n\t\t\t}\n\t\t\treturn this._areaOfPageVisible($page) > $page.outerWidth() * $page.outerHeight() * this.settings.visibleThreshold;\n\t\t}\n\t\t_visiblePages(forceRedraw = false) {\n\t\t\tlet max_area = 0;\n\t\t\tlet i_page = null;\n\t\t\tif (this.pages.length === 0) {\n\t\t\t\tthis._visibles = [];\n\t\t\t\tthis._setActivePage(0);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet $visibles = this.pages.filter(function (pageinfo) {\n\t\t\t\tlet areaVisible = this._areaOfPageVisible(pageinfo.$div);\n\t\t\t\tif (areaVisible > max_area) {\n\t\t\t\t\tmax_area = areaVisible;\n\t\t\t\t\ti_page = pageinfo.$div.data(\"page\");\n\t\t\t\t}\n\t\t\t\treturn areaVisible > 0;\n\t\t\t}.bind(this)).map(x => x.$div);\n\t\t\tthis._setActivePage(i_page);\n\t\t\tlet visibles = $visibles.map(x => {\n\t\t\t\treturn parseInt($(x).data(\"page\"));\n\t\t\t});\n\t\t\tif (visibles.length > 0) {\n\t\t\t\tlet minVisible = Math.min(...visibles);\n\t\t\t\tlet maxVisible = Math.max(...visibles);\n\t\t\t\tfor (let i = Math.max(1, minVisible - this.settings.extraPagesToLoad); i < minVisible; i++) {\n\t\t\t\t\tif (!visibles.includes(i)) visibles.push(i);\n\t\t\t\t}\n\t\t\t\tfor (let i = maxVisible + 1; i <= Math.min(maxVisible + this.settings.extraPagesToLoad, this.pdf.numPages); i++) {\n\t\t\t\t\tif (!visibles.includes(i)) visibles.push(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet nowVisibles = visibles;\n\t\t\tif (!forceRedraw) {\n\t\t\t\tnowVisibles = visibles.filter(function (x) {\n\t\t\t\t\treturn !this._visibles.includes(x);\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t\tthis._visibles.filter(function (x) {\n\t\t\t\treturn !visibles.includes(x);\n\t\t\t}).forEach(function (i) {\n\t\t\t\tthis._cleanPage(this.pages[i].$div);\n\t\t\t}.bind(this));\n\t\t\tthis._visibles = visibles;\n\t\t\tthis.loadPages(...nowVisibles);\n\t\t}\n\t\tloadPages(...pages) {\n\t\t\tthis._pagesLoading.push(...pages);\n\t\t\tif (this._loading) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._loadingTask();\n\t\t}\n\t\t_loadingTask() {\n\t\t\tthis._loading = true;\n\t\t\tif (this._pagesLoading.length > 0) {\n\t\t\t\tlet pagei = this._pagesLoading.shift();\n\t\t\t\tthis.pdf.getPage(pagei).then(function (page) {\n\t\t\t\t\tthis._renderPage(page, pagei);\n\t\t\t\t}.bind(this)).then(function (pageinfo) {\n\t\t\t\t\tif (this._pagesLoading.length > 0) {\n\t\t\t\t\t\tthis._loadingTask();\n\t\t\t\t\t}\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t\tthis._loading = false;\n\t\t}\n\t\tscrollToPage(i) {\n\t\t\tif (this.pages.length === 0 || this.pages[i] === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet $page = this.pages[i].$div;\n\t\t\tif ($page.length === 0) {\n\t\t\t\tconsole.warn(`Page ${i} not found`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet position = $page.position();\n\t\t\tlet containerPosition = this.$container.position();\n\t\t\tif (position !== undefined) {\n\t\t\t\tthis.$container.get(0).scrollTop = this.$container.get(0).scrollTop + position.top - containerPosition.top;\n\t\t\t\tthis.$container.get(0).scrollLeft = this.$container.get(0).scrollLeft + position.left - containerPosition.left;\n\t\t\t}\n\t\t\tthis._setActivePage(i);\n\t\t}\n\t\t_renderPage(page, i) {\n\t\t\tlet pageinfo = this.pages[i];\n\t\t\tlet scale = this.settings.renderingScale;\n\t\t\tlet pixel_ratio = window.devicePixelRatio || 1;\n\t\t\tlet viewport = page.getViewport({\n\t\t\t\trotation: this._rotation,\n\t\t\t\tscale: this._zoom.current * scale\n\t\t\t});\n\t\t\tpageinfo.width = viewport.width / this._zoom.current / scale;\n\t\t\tpageinfo.height = viewport.height / this._zoom.current / scale;\n\t\t\tpageinfo.$div.data(\"width\", pageinfo.width);\n\t\t\tpageinfo.$div.data(\"height\", pageinfo.height);\n\t\t\tpageinfo.$div.width(pageinfo.width * this._zoom.current);\n\t\t\tpageinfo.$div.height(pageinfo.height * this._zoom.current);\n\t\t\tpageinfo.loaded = true;\n\t\t\tlet $canvas = $(\"<canvas></canvas>\");\n\t\t\tlet canvas = $canvas.get(0);\n\t\t\tlet context = canvas.getContext(\"2d\");\n\t\t\tcanvas.height = viewport.height * pixel_ratio;\n\t\t\tcanvas.width = viewport.width * pixel_ratio;\n\t\t\tcanvas.getContext(\"2d\");\n\t\t\tvar transform = pixel_ratio !== 1 ? [pixel_ratio, 0, 0, pixel_ratio, 0, 0] : null;\n\t\t\tvar renderContext = {\n\t\t\t\tcanvasContext: context,\n\t\t\t\tviewport: viewport,\n\t\t\t\ttransform: transform\n\t\t\t};\n\t\t\treturn page.render(renderContext).promise.then(function () {\n\t\t\t\tthis._setPageContent(pageinfo.$div, $canvas);\n\t\t\t\tif (this._documentReady) {\n\t\t\t\t\tif (typeof this.settings.onPageRender === \"function\") {\n\t\t\t\t\t\tthis.settings.onPageRender.call(this, pageinfo.$div.get(0), i);\n\t\t\t\t\t}\n\t\t\t\t\tthis.$container.get(0).dispatchEvent(new CustomEvent(\"pagerender\", {\n\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\tpageNumber: i,\n\t\t\t\t\t\t\tpage: pageinfo.$div.get(0)\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\treturn pageinfo;\n\t\t\t}.bind(this));\n\t\t}\n\t\tgetActivePage() {\n\t\t\tif (this._activePage === null || this.pdf === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (this._activePage < 1 || this._activePage > this.pdf.numPages) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this.pages[this._activePage].$div;\n\t\t}\n\t\tgetPages() {\n\t\t\treturn this.pages;\n\t\t}\n\t\tgetPageCount() {\n\t\t\tif (this.pdf === null) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn this.pdf.numPages;\n\t\t}\n\t\tnext() {\n\t\t\tif (this._activePage < this.pdf.numPages) {\n\t\t\t\tthis.scrollToPage(this._activePage + 1);\n\t\t\t}\n\t\t}\n\t\tprev() {\n\t\t\tif (this._activePage > 1) {\n\t\t\t\tthis.scrollToPage(this._activePage - 1);\n\t\t\t}\n\t\t}\n\t\tfirst() {\n\t\t\tif (this._activePage !== 1) {\n\t\t\t\tthis.scrollToPage(1);\n\t\t\t}\n\t\t}\n\t\tlast() {\n\t\t\tif (this.pdf === null) return;\n\t\t\tif (this._activePage !== this.pdf.numPages) {\n\t\t\t\tthis.scrollToPage(this.pdf.numPages);\n\t\t\t}\n\t\t}\n\t\trotate(deg, accumulate = false) {\n\t\t\tif (accumulate) {\n\t\t\t\tdeg = deg + this._rotation;\n\t\t\t}\n\t\t\tthis._rotation = deg;\n\t\t\tlet container = this.$container.get(0);\n\t\t\tlet prevScroll = {\n\t\t\t\ttop: container.scrollTop,\n\t\t\t\tleft: container.scrollLeft,\n\t\t\t\theight: container.scrollHeight,\n\t\t\t\twidth: container.scrollWidth\n\t\t\t};\n\t\t\treturn this.forceViewerInitialization().then(function () {\n\t\t\t\tlet newScroll = {\n\t\t\t\t\ttop: container.scrollTop,\n\t\t\t\t\tleft: container.scrollLeft,\n\t\t\t\t\theight: container.scrollHeight,\n\t\t\t\t\twidth: container.scrollWidth\n\t\t\t\t};\n\t\t\t\tcontainer.scrollTop = prevScroll.top * (newScroll.height / prevScroll.height);\n\t\t\t\tcontainer.scrollLeft = prevScroll.left * (newScroll.width / prevScroll.width);\n\t\t\t}.bind(this));\n\t\t}\n\t\tforceViewerInitialization() {\n\t\t\tthis.pages = [];\n\t\t\tthis.$container.find(`.${this.settings.pageClass}`).remove();\n\t\t\tthis._pagesLoading = [];\n\t\t\tthis._loading = false;\n\t\t\tthis._visibles = [];\n\t\t\tthis._activePage = null;\n\t\t\treturn this.pdf.getPage(1).then(function (page) {\n\t\t\t\tthis._createSkeletons(page);\n\t\t\t\tthis._visiblePages();\n\t\t\t\tthis._setActivePage(1);\n\t\t\t}.bind(this));\n\t\t}\n\t\tasync loadDocument(document) {\n\t\t\tthis._documentReady = false;\n\t\t\tthis.pages = [];\n\t\t\tthis.$container.find(`.${this.settings.pageClass}`).remove();\n\t\t\tthis.pdf = null;\n\t\t\tlet loadingTask = pdfjsLib.getDocument(document);\n\t\t\treturn loadingTask.promise.then(function (pdf) {\n\t\t\t\tthis.pdf = pdf;\n\t\t\t\tthis.pageCount = pdf.numPages;\n\t\t\t\tthis._rotation = 0;\n\t\t\t\treturn this.forceViewerInitialization();\n\t\t\t}.bind(this)).then(function () {\n\t\t\t\tif (typeof this.settings.onDocumentReady === \"function\") {\n\t\t\t\t\tthis.settings.onDocumentReady.call(this);\n\t\t\t\t}\n\t\t\t\tthis.$container.get(0).dispatchEvent(new CustomEvent(\"documentready\", {\n\t\t\t\t\tdetail: {\n\t\t\t\t\t\tdocument: this.pdf\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\tthis._setActivePage(0);\n\t\t\t\tthis._documentReady = true;\n\t\t\t\tthis._setActivePage(1);\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tfunction recoverAttributes(target, attributeDefaults) {\n\t\tconst camelcaseToSnakecase = str => str.replace(/[A-Z]/g, letter => `-${letter.toLowerCase()}`);\n\t\tlet $target = $(target);\n\t\tlet result = {};\n\t\tif ($target.length > 0) {\n\t\t\t$target = $($target[0]);\n\t\t\tfor (let originalAttributeName in attributeDefaults) {\n\t\t\t\tlet attributeName = camelcaseToSnakecase(originalAttributeName);\n\t\t\t\tlet attributeValue = $target.attr(attributeName);\n\t\t\t\tif (attributeValue != null) {\n\t\t\t\t\tswitch (typeof attributeDefaults[originalAttributeName]) {\n\t\t\t\t\tcase \"float\":\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tattributeValue = parseFloat(attributeValue);\n\t\t\t\t\t\t} catch (_) {}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"number\":\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tattributeValue = parseInt(attributeValue);\n\t\t\t\t\t\t} catch (_) {}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\tlet functionString = attributeValue;\n\t\t\t\t\t\tattributeValue = function () {\n\t\t\t\t\t\t\teval(functionString);\n\t\t\t\t\t\t}.bind(target[0]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tresult[originalAttributeName] = attributeValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init(element) {\n\t\tlet options = recoverAttributes(element, Object.assign({\n\t\t\tpdfDocument: \"\",\n\t\t\tinitialZoom: \"\"\n\t\t}, defaults));\n\t\tif (options[\"pdfDocument\"] != null) {\n\t\t\tlet pdfViewer = new PDFjsViewer($(element), options);\n\t\t\tpdfViewer.loadDocument(options[\"pdfDocument\"]).then(function () {\n\t\t\t\tif (options[\"initialZoom\"] != null) {\n\t\t\t\t\tpdfViewer.setZoom(options[\"initialZoom\"]);\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.get(0).pdfViewer = pdfViewer;\n\t\t}\n\t}\n\t$(function () {\n\t\t$(\".pdfjs-viewer\").each(function () {\n\t\t\tlet $viewer = $(this);\n\t\t\tinit($viewer);\n\t\t});\n\t});\n\texports.PDFjsViewer = PDFjsViewer;\n})(window, window._$ ?? window.jQuery ?? undefined);\n"],"names":["exports","$","undefined","console","error","let","defaults","visibleThreshold","extraPagesToLoad","pageClass","contentClass","onDocumentReady","onNewPage","page","i","onPageRender","zoomValues","onZoomChange","zoomlevel","onActivePageChanged","zoomFillArea","emptyContent","renderingScale","Zoomer","constructor","viewer","options","fillArea","this","current","settings","Object","assign","sort","get","zoom","parseFloat","$activepage","getActivePage","filter","x","length","Math","min","max","$container","width","data","height","zoomPages","getPages","forEach","$page","$div","c_width","c_height","find","bind","PDFjsViewer","version","_zoom","_pdfjsViewer","_setScrollListener","pages","pdf","_documentReady","setZoom","container","prevzoom","prevScroll","top","scrollTop","left","scrollLeft","_visiblePages","call","dispatchEvent","CustomEvent","detail","getZoom","_cleanPage","$emptyContent","html","append","_setPageContent","$content","refreshAll","scrollLock","scrollPos","__scrollHandler","e","abs","clientHeight","clientWidth","off","on","_createSkeleton","pageinfo","loaded","getViewport","viewport","rotation","_rotation","scale","assert","attr","addClass","_placeSkeleton","prevpage","$prevpage","after","_createSkeletons","pageCount","pageNumber","_setActivePage","_activePage","activePage","activePageNumber","_areaOfPageVisible","c_offset","offset","position","bottom","outerHeight","right","outerWidth","page_y0","page_y1","page_x0","page_x1","vis_x","vis_y","isPageVisible","numPages","parseInt","forceRedraw","max_area","i_page","_visibles","$visibles","areaVisible","map","visibles","minVisible","maxVisible","includes","push","nowVisibles","loadPages","_pagesLoading","_loading","_loadingTask","pagei","shift","getPage","then","_renderPage","scrollToPage","warn","containerPosition","pixel_ratio","window","devicePixelRatio","$canvas","canvas","context","getContext","transform","renderContext","canvasContext","render","promise","getPageCount","next","prev","first","last","rotate","deg","accumulate","scrollHeight","scrollWidth","forceViewerInitialization","newScroll","remove","loadDocument","document","loadingTask","pdfjsLib","getDocument","recoverAttributes","target","attributeDefaults","camelcaseToSnakecase","str","replace","letter","toLowerCase","$target","result","originalAttributeName","attributeName","attributeValue","_","functionString","eval","init","element","pdfDocument","initialZoom","pdfViewer","each","$viewer","_$","jQuery"],"mappings":"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"}